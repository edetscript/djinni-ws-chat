{"version":3,"sources":["App.js","index.js"],"names":["App","messages","setMessages","useState","message","setMessage","file","setFile","username","setUsername","localStorage","getItem","isUsernameSet","setIsUsernameSet","ws","useRef","useEffect","current","WebSocket","process","onmessage","event","data","JSON","parse","type","prevMessages","close","handleUsernameSubmit","setItem","_jsx","className","children","_jsxs","map","msg","index","concat","fileUrl","href","target","rel","fileName","placeholder","value","onChange","e","files","onClick","async","formData","FormData","append","response","fetch","method","body","json","messageData","send","stringify","disabled","ReactDOM","render","React","StrictMode","document","getElementById"],"mappings":"mMA6HeA,MA1HHA,KACV,MAAOC,EAAUC,GAAeC,mBAAS,KAClCC,EAASC,GAAcF,mBAAS,KAChCG,EAAMC,GAAWJ,mBAAS,OAC1BK,EAAUC,GAAeN,mBAC9BO,aAAaC,QAAQ,aAAe,KAE/BC,EAAeC,GAAoBV,qBACtCO,aAAaC,QAAQ,aAEnBG,EAAKC,iBAAO,MAElBC,qBAAU,KACRF,EAAGG,QAAU,IAAIC,UAAUC,qCAE3BL,EAAGG,QAAQG,UAAaC,IACtB,MAAMC,EAAOC,KAAKC,MAAMH,EAAMC,MACZ,iBAAdA,EAAKG,KACPvB,EAAYoB,EAAKA,MAEjBpB,GAAawB,GAAiB,IAAIA,EAAcJ,IAClD,EAGK,KACLR,EAAGG,QAAQU,OAAO,IAEnB,IAEH,MAsBMC,EAAuBA,KAC3BlB,aAAamB,QAAQ,WAAYrB,GACjCK,GAAiB,EAAK,EAGxB,OAAKD,EAkBHkB,cAAA,OAAKC,UAAU,MAAKC,SAClBC,eAAA,OAAKF,UAAU,iBAAgBC,SAAA,CAC7BF,cAAA,OAAKC,UAAU,cAAaC,SAC1BF,cAAA,MAAAE,SAAI,iBAENF,cAAA,OAAKC,UAAU,cAAaC,SACzB/B,EAASiC,KAAI,CAACC,EAAKC,IAClBH,eAAA,OACEF,UAAS,gBAAAM,OACPF,EAAI3B,WAAaA,EAAW,cAAgB,IAC3CwB,SAAA,CAGHF,cAAA,UAAAE,SACEF,cAAA,SAAAE,SAAQG,EAAI3B,aAEdsB,cAAA,SACCK,EAAI/B,QACJ+B,EAAIG,SACHR,cAAA,OAAAE,SACEF,cAAA,KACES,KAAMJ,EAAIG,QACVE,OAAO,SACPC,IAAI,sBAAqBT,SAExBG,EAAIO,eAdNN,OAqBXH,eAAA,OAAKF,UAAU,aAAYC,SAAA,CACzBF,cAAA,YACEa,YAAY,oBACZC,MAAOxC,EACPyC,SAAWC,GAAMzC,EAAWyC,EAAEN,OAAOI,SAEvCd,cAAA,SAAOL,KAAK,OAAOoB,SAAWC,GAAMvC,EAAQuC,EAAEN,OAAOO,MAAM,MAC3DjB,cAAA,UAAQkB,QApFIC,UAClB,IAAIP,EAAW,GACXJ,EAAU,GACd,GAAIhC,EAAM,CACR,MAAM4C,EAAW,IAAIC,SACrBD,EAASE,OAAO,OAAQ9C,GACxB,MAAM+C,QAAiBC,MAAMnC,6CAAkC,CAC7DoC,OAAQ,OACRC,KAAMN,IAEF5B,QAAa+B,EAASI,OAC5Bf,EAAWpB,EAAKhB,KAChBgC,EAAO,GAAAD,OAAMlB,sCAA6B,KAAAkB,OAAIf,EAAKhB,KACrD,CAEA,MAAMoD,EAAc,CAAElD,WAAUJ,UAASkC,UAASI,YAElD5B,EAAGG,QAAQ0C,KAAKpC,KAAKqC,UAAUF,IAC/BrD,EAAW,IACXE,EAAQ,KAAK,EAiEuBsD,UAAWzD,IAAYE,EAAK0B,SAAC,iBAvD/DC,eAAA,OAAKF,UAAU,qBAAoBC,SAAA,CACjCF,cAAA,MAAAE,SAAI,oBACJF,cAAA,SACEL,KAAK,OACLkB,YAAY,WACZC,MAAOpC,EACPqC,SAAWC,GAAMrC,EAAYqC,EAAEN,OAAOI,SAExCd,cAAA,UAAQkB,QAASpB,EAAsBiC,UAAWrD,EAASwB,SAAC,gBAoD1D,ECpHV8B,IAASC,OACPjC,cAACkC,IAAMC,WAAU,CAAAjC,SACfF,cAAC9B,EAAG,MAENkE,SAASC,eAAe,Q","file":"static/js/main.cf367463.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport \"./App.css\";\n\nconst App = () => {\n  const [messages, setMessages] = useState([]);\n  const [message, setMessage] = useState(\"\");\n  const [file, setFile] = useState(null);\n  const [username, setUsername] = useState(\n    localStorage.getItem(\"username\") || \"\"\n  );\n  const [isUsernameSet, setIsUsernameSet] = useState(\n    !!localStorage.getItem(\"username\")\n  );\n  const ws = useRef(null);\n\n  useEffect(() => {\n    ws.current = new WebSocket(process.env.REACT_APP_WEBSOCKET_URL);\n\n    ws.current.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      if (data.type === \"pastMessages\") {\n        setMessages(data.data);\n      } else {\n        setMessages((prevMessages) => [...prevMessages, data]);\n      }\n    };\n\n    return () => {\n      ws.current.close();\n    };\n  }, []);\n\n  const sendMessage = async () => {\n    let fileName = \"\";\n    let fileUrl = \"\";\n    if (file) {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const response = await fetch(process.env.REACT_APP_UPLOAD_URL, {\n        method: \"POST\",\n        body: formData,\n      });\n      const data = await response.json();\n      fileName = data.file;\n      fileUrl = `${process.env.REACT_APP_API_URL}/${data.file}`;\n    }\n\n    const messageData = { username, message, fileUrl, fileName };\n\n    ws.current.send(JSON.stringify(messageData));\n    setMessage(\"\");\n    setFile(null);\n  };\n\n  const handleUsernameSubmit = () => {\n    localStorage.setItem(\"username\", username);\n    setIsUsernameSet(true);\n  };\n\n  if (!isUsernameSet) {\n    return (\n      <div className=\"username-container\">\n        <h4>Pick a username</h4>\n        <input\n          type=\"text\"\n          placeholder=\"Username\"\n          value={username}\n          onChange={(e) => setUsername(e.target.value)}\n        />\n        <button onClick={handleUsernameSubmit} disabled={!username}>\n          Join Chat\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"chat-container\">\n        <div className=\"chat-header\">\n          <h1>Group Chat</h1>\n        </div>\n        <div className=\"chat-window\">\n          {messages.map((msg, index) => (\n            <div\n              className={`chat-message ${\n                msg.username === username ? \"own-message\" : \"\"\n              }`}\n              key={index}\n            >\n              <strong>\n                <small>{msg.username}</small>\n              </strong>\n              <br />\n              {msg.message}\n              {msg.fileUrl && (\n                <div>\n                  <a\n                    href={msg.fileUrl}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    {msg.fileName}\n                  </a>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n        <div className=\"chat-input\">\n          <textarea\n            placeholder=\"Type your message\"\n            value={message}\n            onChange={(e) => setMessage(e.target.value)}\n          />\n          <input type=\"file\" onChange={(e) => setFile(e.target.files[0])} />\n          <button onClick={sendMessage} disabled={!message && !file}>\n            Send\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}