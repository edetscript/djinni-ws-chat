(this["webpackJsonpdjinni-ws-chat-client"]=this["webpackJsonpdjinni-ws-chat-client"]||[]).push([[0],{11:function(e,t,c){"use strict";c.r(t);var s=c(1),n=c.n(s),a=c(3),l=c.n(a),i=(c(8),c(9),c(0));var r=()=>{const[e,t]=Object(s.useState)([]),[c,n]=Object(s.useState)(""),[a,l]=Object(s.useState)(!1),[r,j]=Object(s.useState)(null),[d,o]=Object(s.useState)(localStorage.getItem("username")||""),h=Object(s.useRef)(null),b=Object(s.useRef)(null),[u,O]=Object(s.useState)(!!localStorage.getItem("username")),m=()=>{const e=b.current;e.style.height="auto",e.style.height="".concat(e.scrollHeight,"px")},x=Object(s.useRef)(null);Object(s.useEffect)((()=>(x.current=new WebSocket("wss://djinni-ws-chat.onrender.com"),x.current.onmessage=e=>{const c=JSON.parse(e.data);"pastMessages"===c.type?t(c.data):t((e=>[...e,c]))},()=>{x.current.close()})),[]);Object(s.useEffect)((()=>{m()}),[c]);const g=()=>{localStorage.setItem("username",d),O(!0)};return u?Object(i.jsx)("div",{className:"App",children:Object(i.jsxs)("div",{className:"chat-container",children:[Object(i.jsx)("div",{className:"chat-header",children:Object(i.jsx)("h1",{children:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0447\u0430\u0442"})}),Object(i.jsx)("div",{className:"chat-window",children:e.map(((e,t)=>Object(i.jsxs)("div",{className:"chat-message ".concat(e.username===d?"own-message":""),children:[Object(i.jsx)("strong",{children:Object(i.jsx)("small",{children:e.username})}),Object(i.jsx)("br",{}),e.message,e.fileUrl&&Object(i.jsx)("ul",{children:[".jpg",".jpeg",".png",".gif",".webp",".svg"].some((t=>{var c;return null===e||void 0===e||null===(c=e.fileName)||void 0===c?void 0:c.toLowerCase().endsWith(t)}))?Object(i.jsx)("li",{children:Object(i.jsx)("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",children:Object(i.jsx)("img",{className:"uploaded-image",src:e.fileUrl,alt:e.fileName,width:"80px"})})}):Object(i.jsx)("li",{className:"uploaded-file",children:Object(i.jsx)("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",children:e.fileName})})})]},t)))}),Object(i.jsxs)("div",{className:"chat-input-wrapper",children:[Object(i.jsx)("div",{className:"chat-editor-upload",children:Object(i.jsx)("button",{className:"plus-icon",onClick:()=>{h.current.click()},title:"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u0430\u0439\u043b",children:Object(i.jsxs)("svg",{"enable-background":"new 0 0 24 24",height:"20",viewBox:"0 0 24 24",width:"20",focusable:"false",children:[Object(i.jsx)("g",{children:Object(i.jsx)("rect",{fill:"none",height:"20",width:"20"})}),Object(i.jsx)("g",{children:Object(i.jsx)("g",{children:Object(i.jsx)("g",{children:Object(i.jsx)("path",{d:"M6,2C4.9,2,4.01,2.9,4.01,4L4,20c0,1.1,0.89,2,1.99,2H18c1.1,0,2-0.9,2-2V8l-6-6H6z M13,9V3.5L18.5,9H13z"})})})})]})})}),Object(i.jsxs)("div",{className:"padding-10",children:[Object(i.jsxs)("div",{className:"chat-input",children:[Object(i.jsx)("textarea",{ref:b,placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435...",value:c,onChange:e=>{n(e.target.value),m()}}),Object(i.jsx)("button",{onClick:async()=>{l(!0);let e="",t="";if(r){const c=new FormData;c.append("file",r);const s=await fetch("https://djinni-ws-chat.onrender.com/upload",{method:"POST",body:c});e=(await s.json()).fileUrl,t=r.name}const s={username:d,message:c,fileUrl:e,fileName:t};x.current.send(JSON.stringify(s)),n(""),j(null),l(!1)},disabled:!c&&!r,children:a?"\u041e\u0442\u043f\u0440\u0430\u0432\u043a\u0430...":"\u041e\u0442\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c"})]}),Object(i.jsx)("small",{children:null===r||void 0===r?void 0:r.name}),Object(i.jsx)("input",{type:"file",ref:h,className:"hidden",onChange:e=>j(e.target.files[0])})]})]})]})}):Object(i.jsxs)("div",{className:"username-container",children:[Object(i.jsx)("h4",{children:"Pick a username"}),Object(i.jsx)("input",{type:"text",placeholder:"Username",value:d,onChange:e=>o(e.target.value)}),Object(i.jsx)("button",{onClick:g,disabled:!d,children:"Join Chat"})]})};l.a.render(Object(i.jsx)(n.a.StrictMode,{children:Object(i.jsx)(r,{})}),document.getElementById("root"))},8:function(e,t,c){},9:function(e,t,c){}},[[11,1,2]]]);
//# sourceMappingURL=main.7f8b6011.chunk.js.map