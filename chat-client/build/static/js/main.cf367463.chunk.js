(this["webpackJsonpdjinni-ws-chat-client"]=this["webpackJsonpdjinni-ws-chat-client"]||[]).push([[0],{11:function(e,t,n){"use strict";n.r(t);var c=n(1),s=n.n(c),a=n(3),r=n.n(a),i=(n(8),n(9),n(0));var l=()=>{const[e,t]=Object(c.useState)([]),[n,s]=Object(c.useState)(""),[a,r]=Object(c.useState)(null),[l,o]=Object(c.useState)(localStorage.getItem("username")||""),[j,d]=Object(c.useState)(!!localStorage.getItem("username")),h=Object(c.useRef)(null);Object(c.useEffect)((()=>(h.current=new WebSocket("wss://djinni-ws-chat.onrender.com"),h.current.onmessage=e=>{const n=JSON.parse(e.data);"pastMessages"===n.type?t(n.data):t((e=>[...e,n]))},()=>{h.current.close()})),[]);const u=()=>{localStorage.setItem("username",l),d(!0)};return j?Object(i.jsx)("div",{className:"App",children:Object(i.jsxs)("div",{className:"chat-container",children:[Object(i.jsx)("div",{className:"chat-header",children:Object(i.jsx)("h1",{children:"Group Chat"})}),Object(i.jsx)("div",{className:"chat-window",children:e.map(((e,t)=>Object(i.jsxs)("div",{className:"chat-message ".concat(e.username===l?"own-message":""),children:[Object(i.jsx)("strong",{children:Object(i.jsx)("small",{children:e.username})}),Object(i.jsx)("br",{}),e.message,e.fileUrl&&Object(i.jsx)("div",{children:Object(i.jsx)("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",children:e.fileName})})]},t)))}),Object(i.jsxs)("div",{className:"chat-input",children:[Object(i.jsx)("textarea",{placeholder:"Type your message",value:n,onChange:e=>s(e.target.value)}),Object(i.jsx)("input",{type:"file",onChange:e=>r(e.target.files[0])}),Object(i.jsx)("button",{onClick:async()=>{let e="",t="";if(a){const n=new FormData;n.append("file",a);const c=await fetch("https://djinni-ws-chat.onrender.com/upload",{method:"POST",body:n}),s=await c.json();e=s.file,t="".concat("https://djinni-ws-chat.onrender.com","/").concat(s.file)}const c={username:l,message:n,fileUrl:t,fileName:e};h.current.send(JSON.stringify(c)),s(""),r(null)},disabled:!n&&!a,children:"Send"})]})]})}):Object(i.jsxs)("div",{className:"username-container",children:[Object(i.jsx)("h4",{children:"Pick a username"}),Object(i.jsx)("input",{type:"text",placeholder:"Username",value:l,onChange:e=>o(e.target.value)}),Object(i.jsx)("button",{onClick:u,disabled:!l,children:"Join Chat"})]})};r.a.render(Object(i.jsx)(s.a.StrictMode,{children:Object(i.jsx)(l,{})}),document.getElementById("root"))},8:function(e,t,n){},9:function(e,t,n){}},[[11,1,2]]]);
//# sourceMappingURL=main.cf367463.chunk.js.map