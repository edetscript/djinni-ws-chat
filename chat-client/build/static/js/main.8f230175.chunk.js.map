{"version":3,"sources":["App.js","index.js"],"names":["App","messages","setMessages","useState","message","setMessage","file","setFile","username","setUsername","localStorage","getItem","isUsernameSet","setIsUsernameSet","ws","useRef","useEffect","current","WebSocket","process","onmessage","event","data","JSON","parse","type","prevMessages","close","handleUsernameSubmit","setItem","_jsx","className","children","_jsxs","console","log","map","msg","index","concat","fileUrl","href","target","rel","fileName","placeholder","value","onChange","e","files","onClick","async","formData","FormData","append","response","fetch","method","body","json","messageData","send","stringify","disabled","ReactDOM","render","React","StrictMode","document","getElementById"],"mappings":"mMA8HeA,MA3HHA,KACV,MAAOC,EAAUC,GAAeC,mBAAS,KAClCC,EAASC,GAAcF,mBAAS,KAChCG,EAAMC,GAAWJ,mBAAS,OAC1BK,EAAUC,GAAeN,mBAC9BO,aAAaC,QAAQ,aAAe,KAE/BC,EAAeC,GAAoBV,qBACtCO,aAAaC,QAAQ,aAEnBG,EAAKC,iBAAO,MAElBC,qBAAU,KACRF,EAAGG,QAAU,IAAIC,UAAUC,uBAE3BL,EAAGG,QAAQG,UAAaC,IACtB,MAAMC,EAAOC,KAAKC,MAAMH,EAAMC,MACZ,iBAAdA,EAAKG,KACPvB,EAAYoB,EAAKA,MAEjBpB,GAAawB,GAAiB,IAAIA,EAAcJ,IAClD,EAGK,KACLR,EAAGG,QAAQU,OAAO,IAEnB,IAEH,MAsBMC,EAAuBA,KAC3BlB,aAAamB,QAAQ,WAAYrB,GACjCK,GAAiB,EAAK,EAGxB,OAAKD,EAkBHkB,cAAA,OAAKC,UAAU,MAAKC,SAClBC,eAAA,OAAKF,UAAU,iBAAgBC,SAAA,CAC7BF,cAAA,OAAKC,UAAU,cAAaC,SAC1BF,cAAA,MAAAE,SAAI,iBAELE,QAAQC,IAAIlC,GACb6B,cAAA,OAAKC,UAAU,cAAaC,SACzB/B,EAASmC,KAAI,CAACC,EAAKC,IAClBL,eAAA,OACEF,UAAS,gBAAAQ,OACPF,EAAI7B,WAAaA,EAAW,cAAgB,IAC3CwB,SAAA,CAGHF,cAAA,UAAAE,SACEF,cAAA,SAAAE,SAAQK,EAAI7B,aAEdsB,cAAA,SACCO,EAAIjC,QACJiC,EAAIG,SACHV,cAAA,OAAAE,SACEF,cAAA,KACEW,KAAMJ,EAAIG,QACVE,OAAO,SACPC,IAAI,sBAAqBX,SAExBK,EAAIO,eAdNN,OAqBXL,eAAA,OAAKF,UAAU,aAAYC,SAAA,CACzBF,cAAA,YACEe,YAAY,oBACZC,MAAO1C,EACP2C,SAAWC,GAAM3C,EAAW2C,EAAEN,OAAOI,SAEvChB,cAAA,SAAOL,KAAK,OAAOsB,SAAWC,GAAMzC,EAAQyC,EAAEN,OAAOO,MAAM,MAC3DnB,cAAA,UAAQoB,QArFIC,UAClB,IAAIP,EAAW,GACXJ,EAAU,GACd,GAAIlC,EAAM,CACR,MAAM8C,EAAW,IAAIC,SACrBD,EAASE,OAAO,OAAQhD,GACxB,MAAMiD,QAAiBC,MAAMrC,+BAAkC,CAC7DsC,OAAQ,OACRC,KAAMN,IAEF9B,QAAaiC,EAASI,OAC5Bf,EAAWtB,EAAKhB,KAChBkC,EAAO,GAAAD,OAAMpB,wBAA6B,KAAAoB,OAAIjB,EAAKhB,KACrD,CAEA,MAAMsD,EAAc,CAAEpD,WAAUJ,UAASoC,UAASI,YAElD9B,EAAGG,QAAQ4C,KAAKtC,KAAKuC,UAAUF,IAC/BvD,EAAW,IACXE,EAAQ,KAAK,EAkEuBwD,UAAW3D,IAAYE,EAAK0B,SAAC,iBAxD/DC,eAAA,OAAKF,UAAU,qBAAoBC,SAAA,CACjCF,cAAA,MAAAE,SAAI,oBACJF,cAAA,SACEL,KAAK,OACLoB,YAAY,WACZC,MAAOtC,EACPuC,SAAWC,GAAMvC,EAAYuC,EAAEN,OAAOI,SAExChB,cAAA,UAAQoB,QAAStB,EAAsBmC,UAAWvD,EAASwB,SAAC,gBAqD1D,ECrHVgC,IAASC,OACPnC,cAACoC,IAAMC,WAAU,CAAAnC,SACfF,cAAC9B,EAAG,MAENoE,SAASC,eAAe,Q","file":"static/js/main.8f230175.chunk.js","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport \"./App.css\";\n\nconst App = () => {\n  const [messages, setMessages] = useState([]);\n  const [message, setMessage] = useState(\"\");\n  const [file, setFile] = useState(null);\n  const [username, setUsername] = useState(\n    localStorage.getItem(\"username\") || \"\"\n  );\n  const [isUsernameSet, setIsUsernameSet] = useState(\n    !!localStorage.getItem(\"username\")\n  );\n  const ws = useRef(null);\n\n  useEffect(() => {\n    ws.current = new WebSocket(process.env.REACT_APP_WEBSOCKET_URL);\n\n    ws.current.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      if (data.type === \"pastMessages\") {\n        setMessages(data.data);\n      } else {\n        setMessages((prevMessages) => [...prevMessages, data]);\n      }\n    };\n\n    return () => {\n      ws.current.close();\n    };\n  }, []);\n\n  const sendMessage = async () => {\n    let fileName = \"\";\n    let fileUrl = \"\";\n    if (file) {\n      const formData = new FormData();\n      formData.append(\"file\", file);\n      const response = await fetch(process.env.REACT_APP_UPLOAD_URL, {\n        method: \"POST\",\n        body: formData,\n      });\n      const data = await response.json();\n      fileName = data.file;\n      fileUrl = `${process.env.REACT_APP_API_URL}/${data.file}`;\n    }\n\n    const messageData = { username, message, fileUrl, fileName };\n\n    ws.current.send(JSON.stringify(messageData));\n    setMessage(\"\");\n    setFile(null);\n  };\n\n  const handleUsernameSubmit = () => {\n    localStorage.setItem(\"username\", username);\n    setIsUsernameSet(true);\n  };\n\n  if (!isUsernameSet) {\n    return (\n      <div className=\"username-container\">\n        <h4>Pick a username</h4>\n        <input\n          type=\"text\"\n          placeholder=\"Username\"\n          value={username}\n          onChange={(e) => setUsername(e.target.value)}\n        />\n        <button onClick={handleUsernameSubmit} disabled={!username}>\n          Join Chat\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"App\">\n      <div className=\"chat-container\">\n        <div className=\"chat-header\">\n          <h1>Group Chat</h1>\n        </div>\n        {console.log(messages)}\n        <div className=\"chat-window\">\n          {messages.map((msg, index) => (\n            <div\n              className={`chat-message ${\n                msg.username === username ? \"own-message\" : \"\"\n              }`}\n              key={index}\n            >\n              <strong>\n                <small>{msg.username}</small>\n              </strong>\n              <br />\n              {msg.message}\n              {msg.fileUrl && (\n                <div>\n                  <a\n                    href={msg.fileUrl}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                  >\n                    {msg.fileName}\n                  </a>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n        <div className=\"chat-input\">\n          <textarea\n            placeholder=\"Type your message\"\n            value={message}\n            onChange={(e) => setMessage(e.target.value)}\n          />\n          <input type=\"file\" onChange={(e) => setFile(e.target.files[0])} />\n          <button onClick={sendMessage} disabled={!message && !file}>\n            Send\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}