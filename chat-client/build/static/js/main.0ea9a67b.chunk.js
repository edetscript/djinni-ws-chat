(this["webpackJsonpdjinni-ws-chat-client"]=this["webpackJsonpdjinni-ws-chat-client"]||[]).push([[0],{11:function(e,t,n){"use strict";n.r(t);var a=n(1),s=n.n(a),c=n(3),r=n.n(c),l=(n(8),n(9),n(0));var i=()=>{const[e,t]=Object(a.useState)([]),[n,s]=Object(a.useState)(""),[c,r]=Object(a.useState)(!1),[i,o]=Object(a.useState)(null),[j,d]=Object(a.useState)(localStorage.getItem("username")||""),[h,u]=Object(a.useState)(!!localStorage.getItem("username")),b=Object(a.useRef)(null);Object(a.useEffect)((()=>(b.current=new WebSocket("wss://djinni-ws-chat.onrender.com"),b.current.onmessage=e=>{const n=JSON.parse(e.data);"pastMessages"===n.type?t(n.data):t((e=>[...e,n]))},()=>{b.current.close()})),[]);const m=()=>{localStorage.setItem("username",j),u(!0)};return h?Object(l.jsx)("div",{className:"App",children:Object(l.jsxs)("div",{className:"chat-container",children:[Object(l.jsx)("div",{className:"chat-header",children:Object(l.jsx)("h1",{children:"Group Chat"})}),Object(l.jsx)("div",{className:"chat-window",children:e.map(((e,t)=>Object(l.jsxs)("div",{className:"chat-message ".concat(e.username===j?"own-message":""),children:[Object(l.jsx)("strong",{children:Object(l.jsx)("small",{children:e.username})}),Object(l.jsx)("br",{}),e.message,e.fileUrl&&Object(l.jsx)("div",{children:[".jpg",".jpeg",".png",".gif",".webp",".svg"].some((t=>{var n;return null===e||void 0===e||null===(n=e.fileName)||void 0===n?void 0:n.toLowerCase().endsWith(t)}))?Object(l.jsx)("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",children:Object(l.jsx)("img",{src:e.fileUrl,alt:e.fileName,width:"80px"})}):Object(l.jsx)("a",{href:e.fileUrl,target:"_blank",rel:"noopener noreferrer",children:e.fileName})})]},t)))}),Object(l.jsxs)("div",{className:"chat-input",children:[Object(l.jsx)("textarea",{placeholder:"Type your message",value:n,onChange:e=>s(e.target.value)}),Object(l.jsx)("input",{type:"file",onChange:e=>o(e.target.files[0])}),Object(l.jsx)("button",{onClick:async()=>{r(!0);let e="",t="";if(i){const n=new FormData;n.append("file",i);const a=await fetch("https://djinni-ws-chat.onrender.com/upload",{method:"POST",body:n});e=(await a.json()).fileUrl,t=i.name}const a={username:j,message:n,fileUrl:e,fileName:t};b.current.send(JSON.stringify(a)),s(""),o(null),r(!1)},disabled:!n&&!i,children:c?"Sending...":"Send"})]})]})}):Object(l.jsxs)("div",{className:"username-container",children:[Object(l.jsx)("h4",{children:"Pick a username"}),Object(l.jsx)("input",{type:"text",placeholder:"Username",value:j,onChange:e=>d(e.target.value)}),Object(l.jsx)("button",{onClick:m,disabled:!j,children:"Join Chat"})]})};r.a.render(Object(l.jsx)(s.a.StrictMode,{children:Object(l.jsx)(i,{})}),document.getElementById("root"))},8:function(e,t,n){},9:function(e,t,n){}},[[11,1,2]]]);
//# sourceMappingURL=main.0ea9a67b.chunk.js.map